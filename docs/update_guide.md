# Оновлення проєкту

## 1. Підготовка до оновлення
Перед початком оновлення необхідно підготуватися, щоб мінімізувати ризики та час простою.

### 1.1 Створення резервних копій
Перед оновленням необхідно створити резервні копії:
- **Коду проєкту** (Git repository backup)
- **Бази даних** (MongoDB dump)
- **Файлів конфігурації** (збереження `.env` файлів)
- **Логів серверів** (на випадок аналізу проблем після оновлення)

#### Команди для резервного копіювання MongoDB:
```sh
mongodump --url="mongodb+srv://user:password@cluster.mongodb.net/" --out=/backups/$(date +%F)
```

### 1.2 Перевірка сумісності
Перед розгортанням оновлення перевірте:
- **Вимоги до версій** (Node.js, MongoDB, бібліотек)
- **Зміни в базі даних** (чи є необхідність у міграції даних)
- **Залежності** (перевірте `package.json` на оновлення)
- **Зворотну сумісність API** (щоб не порушити клієнтів)

### 1.3 Планування часу простою
- Якщо оновлення вимагає зупинки серверів, оберіть час із **мінімальним навантаженням**.
- Повідомте користувачів або команду про можливий простій.

## 2. Процес оновлення

### 2.1 Зупинка потрібних служб
-

### 2.2 Розгортання нового коду
Перейдіть у папку проєкту та виконайте оновлення:
```sh
git pull origin main  # Або потрібна гілка
npm install  # Оновлення залежностей
npm run build  # Перекомпіляція Next.js
```

### 2.3 Міграція даних (якщо потрібно)
Якщо оновлення вимагає змін у базі даних:
```sh
node migrate.js  # Виконати міграції, якщо вони є
```

### 2.4 Оновлення конфігурацій
Перевірте зміни в `.env` та інших конфігураційних файлах. Переконайтесь, що змінені лише потрібні параметри

## 3. Перевірка після оновлення

### 3.1 Перезапуск сервісів

### 3.2 Перевірка статусу
```sh
mongo --eval "db.stats()"  # Переконатися, що база працює
```

### 3.3 Перевірка працездатності
- Відкрийте вебдодаток і протестуйте основні функції.
- Перевірте лог-файли на наявність помилок.

## 4. Процедура відкату (rollback)
Якщо оновлення спричинило критичні проблеми:

### 4.1 Відкат коду
```sh
git reset --hard HEAD~1  # Повернутись на попередню версію
npm install
npm run build
```

### 4.2 Відновлення бази даних
```sh
mongorestore --uri="mongodb+srv://user:password@cluster.mongodb.net/" /backups/2025-03-27
```

### 4.4 Повторна перевірка
Виконайте ті ж перевірки, що після оновлення, щоб переконатися, що система повернулася у стабільний стан.

